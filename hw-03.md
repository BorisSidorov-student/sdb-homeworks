# Домашнее задание к занятию "`ELK`" - `Сидоров Борис`

### Задание 1. Elasticsearch 

Установите и запустите Elasticsearch, после чего поменяйте параметр cluster_name на случайный. 

*Приведите скриншот команды 'curl -X GET 'localhost:9200/_cluster/health?pretty', сделанной на сервере с установленным Elasticsearch. Где будет виден нестандартный cluster_name*.

---

### Решение 1
Для решения задачи по развертыванию сервиса **`Elasticsearch`** буду использовать **`docker`**, а именно буду поднимать контейнеры через **`docker compose`**. Первым делом создам файл **`compose.yml`** в котором опишу развертывание сервиса **`elasticsearch`**. Из важного 
- укажу проброс порта **`9200`**, 
- **`discovery.type=single-node`** переменные окружения для работы в режиме **`single-node`**, 
- **`xpack.security.enabled=false`** отключу функции аутентификации и авторизации, так как это тестовая среда.

Ключевой момент для решения задания подложу измененный конфиг в директиве **`volumes`** где будет использоваться нестандартное имя для поля **`cluster_name`**:  
**`./elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml`**

Запускаю **`docker compose up -d`**.
![docker compose up -d](screen/hw-03/task-1/hw-03-1.1.png)

![docker ps](screen/hw-03/task-1/hw-03-1.1(a).png)

Ранее уже пробовал запускать контейнер поэтому процесс прошел быстро. Сразу проверю через **`curl`** состояние сервиса.
![curl](screen/hw-03/task-1/hw-03-1.2.png)

Вижу, что конфигурационный файл используется тот что указан в директиве **`volumes`** и **`cluster_name`** такой какой я указал, а не дефолтный **`docker-cluster`**.

**`docker compose file`** для первого задания тут:
[**`docker-compose-task1.yml`**](docker-compose/docker-compose-task1.yml)

конфигурационный файл для **`elasticsearch`** тут:
[**`elasticsearch.yml`**](configs/elasticsearch.yml)

---
---

### Задание 2. Kibana

Установите и запустите Kibana.

*Приведите скриншот интерфейса Kibana на странице http://<ip вашего сервера>:5601/app/dev_tools#/console, где будет выполнен запрос GET /_cluster/health?pretty*.

---

### Решение 2
Продолжаю работать в рамках проекта **`docker-compose.yml`**. Для запуска сервиса **`kibana`** мне потребуется дописать параметры требуемого мне сервиса а именно:

- **`image: kibana:8.14.3`** — образ из которого буду разворачивать контейнер
- **`ports: 5601:5601`** — проброс портов с хоста в контейнер для доступа к веб интерфейсу
- **`depends_on: elasticsearch`** — зависимость запуска от сервиса **`elasticsearch`**, так как без **`elasticsearch`** сервис **`kibana`** бессмысленно поднимать
- **`environment: ELASTICSEARCH_HOSTS=http://elasticsearch:9200`** — переменная окружения в котором передаем адрес до нашего хранилища логов, так как **`docker`** проект будет запускаться в рамках одной сети **`docker`**, можно использовать имя сервиса вместо поиска **`ip`** **`elasticsearch`**

Итоговый файл **`docker compose`**:
[**`docker-compose-task2.yml`**](docker-compose/docker-compose-task2.yml)

Запускаем проект и проверяем работу сервиса.
![docker run](screen/hw-03/task-2/hw-03-2.1.png)

![kibana web](screen/hw-03/task-2/hw-03-2.2.png)

Сервис работает.
Теперь выполняем задачу по заданию. Выполняем запрос **`GET /_cluster/health?pretty`** прямо в консоли клиента **`dev tools`** в веб-интерфейсе **`kibana`**.
![dev tools](screen/hw-03/task-2/hw-03-2.3.png)

Видно, что обращение к **`Elasticsearch`** работает и в выводе получили ответ со статусом **`200`** и данными.

---
---






